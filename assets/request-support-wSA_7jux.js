import"./modulepreload-polyfill-B5Qt9EMX.js";import{s as i}from"./supabase-vDZkBp_j.js";async function u(){const{data:o,error:e}=await i.from("profiles").select("id, full_name").order("full_name");if(e)return;const s=document.getElementById("member-in-need");o.forEach(t=>{const n=document.createElement("option");n.value=t.id,n.textContent=t.full_name,s.appendChild(n)})}u();async function a(){const{data:{user:o}}=await i.auth.getUser();if(!o)return;const{data:e,error:s}=await i.from("support_requests").select("id, mission_title").eq("member_in_need_id",o.id).eq("status","active");if(s||!e||e.length===0)return;document.getElementById("received-support-section").style.display="block";const t=document.getElementById("support-sought-select");e.forEach(n=>{const r=document.createElement("option");r.value=n.mission_title,r.textContent=n.mission_title,t.appendChild(r)})}a();document.getElementById("support-form").onsubmit=async o=>{o.preventDefault();const e=document.getElementById("form-status");e.textContent="Submitting...",e.style.color="#333";const{data:{user:s}}=await i.auth.getUser();if(!s){e.textContent="Error: You must be logged in to submit a request.",e.style.color="red";return}const t=new FormData(o.target),n={requestor_id:s.id,member_in_need_id:t.get("member_in_need_id"),mission_title:t.get("mission_title"),mission_description:t.get("mission_description"),funding_goal:t.get("funding_goal")?parseFloat(t.get("funding_goal")):null,funds_usage_details:t.get("funds_usage_details"),payment_link:t.get("payment_link"),payment_link_2:t.get("payment_link_2")},{error:r}=await i.from("support_requests").insert([n]);r?(e.textContent="Error: "+r.message,e.style.color="red"):(e.textContent="Success! Your support request has been posted.",e.style.color="#2e8b57",o.target.reset(),a())};document.getElementById("received-support-form").onsubmit=async o=>{o.preventDefault();const e=document.getElementById("received-status");e.textContent="Logging...",e.style.color="#333";const{data:{user:s}}=await i.auth.getUser();if(!s){e.textContent="Error: You must be logged in.",e.style.color="red";return}const t=new FormData(o.target),n={recipient_id:s.id,support_sought:t.get("support_sought"),dollars_received:parseFloat(t.get("dollars_received")),received_at:t.get("received_at")},{error:r}=await i.from("support_received").insert([n]);r?(e.textContent="Error: "+r.message,e.style.color="red"):(e.textContent="Success! Received support logged.",e.style.color="#2e8b57",o.target.reset())};
