import"./modulepreload-polyfill-B5Qt9EMX.js";import{s as i}from"./supabase-vDZkBp_j.js";async function N(){const o="81c50097-74f3-4c7a-b00c-598995b8d1cb",r={},s={},{data:m}=await i.from("writers_wall").select("author_id, points");m&&m.forEach(e=>{e.author_id&&(s[e.author_id]=s[e.author_id]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,help_hours:0,help_points:0,help_hours_recent:0,support_responses:0,events_created:0,events_attended:0,projects_proposed:0,writer_posts:0,writer_points:0,positive_impact:0},s[e.author_id].writer_posts=(s[e.author_id].writer_posts||0)+1,s[e.author_id].writer_points=(s[e.author_id].writer_points||0)+(e.points||0))});const{data:u}=await i.from("member_video").select("user_id");if(u){const e={};u.forEach(t=>{t.user_id&&t.user_id!==o&&(e[t.user_id]=(e[t.user_id]||0)+1)}),Object.entries(e).forEach(([t,a])=>{s[t]=s[t]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,help_hours:0,help_points:0,help_hours_recent:0,support_responses:0,events_created:0,events_attended:0,projects_proposed:0,writer_posts:0,writer_points:0,videos_posted:0,positive_impact:0},s[t].videos_posted=a,r[t]=(r[t]||0)+a*5})}const{data:E}=await i.from("help_given").select("helper_id, hours").order("created_at",{ascending:!1}),_={},d={};E?.forEach(e=>{e.helper_id&&e.hours&&e.helper_id!==o&&(_[e.helper_id]=(_[e.helper_id]||0)+Number(e.hours),d[e.helper_id]=d[e.helper_id]||[],d[e.helper_id].push(Number(e.hours)))}),Object.entries(_).forEach(([e,t])=>{s[e]=s[e]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,help_hours:0,help_points:0,help_hours_recent:0,support_responses:0,positive_impact:0},s[e].help_hours=t,s[e].help_points=t*5,s[e].help_hours_recent=(d[e]||[]).reduce((a,c)=>a+c,0),r[e]=(r[e]||0)+t*5});const{data:h}=await i.from("event_attendance").select("user_id");console.log("DEBUG: attendedActs from event_attendance",h);const p={};h?.forEach(e=>{e.user_id&&e.user_id!==o&&(p[e.user_id]=(p[e.user_id]||0)+1)}),Object.entries(p).forEach(([e,t])=>{s[e]=s[e]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,events_created:0,events_attended:0,projects_proposed:0,support_responses:0},s[e].events_attended=t,r[e]=(r[e]||0)+t*5});const{data:k}=await i.from("events").select("created_by"),l={};k?.forEach(e=>{e.created_by&&e.created_by!==o&&(l[e.created_by]=(l[e.created_by]||0)+1)}),Object.entries(l).forEach(([e,t])=>{s[e]=s[e]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,events_created:0,events_attended:0,projects_proposed:0,support_responses:0,positive_impact:0},s[e].events_created=t,r[e]=(r[e]||0)+t*5});const{data:$}=await i.from("support_responses").select("responder_id"),f={};$?.forEach(e=>{e.responder_id&&e.responder_id!==o&&(f[e.responder_id]=(f[e.responder_id]||0)+1)}),Object.entries(f).forEach(([e,t])=>{s[e]=s[e]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,events_created:0,support_responses:0,positive_impact:0},s[e].support_responses=t,r[e]=(r[e]||0)+t*5});const{data:P}=await i.from("agreement_votes").select("voter_id, created_at"),{data:B}=await i.from("suggestions").select("author_id, created_at"),{data:O}=await i.from("comments").select("author_id, created_at"),{data:U}=await i.from("member_offerings").select("user_id, want, give, passion"),{data:A}=await i.from("contributions").select("user_id, project, challenge, help, collab, skills, urgency, contact"),{data:C}=await i.from("profiles").select("id, full_name, bio, avatar_url, youtube, twitter, substack, facebook, instagram, linkedin, website"),{data:T}=await i.from("circles").select("created_by"),{data:M}=await i.from("circle_members").select("added_by"),{data:W}=await i.from("celebrations").select("user_id"),{data:G}=await i.from("group_projects").select("proposer_id");P?.forEach(e=>{e.voter_id!==o&&(r[e.voter_id]=(r[e.voter_id]||0)+1,s[e.voter_id]=s[e.voter_id]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},s[e.voter_id].votes+=1)}),B?.forEach(e=>{e.author_id!==o&&(r[e.author_id]=(r[e.author_id]||0)+1,s[e.author_id]=s[e.author_id]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},s[e.author_id].suggestions+=1)}),O?.forEach(e=>{e.author_id!==o&&(r[e.author_id]=(r[e.author_id]||0)+1,s[e.author_id]=s[e.author_id]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},s[e.author_id].comments+=1)});const b={};G?.forEach(e=>{e.proposer_id&&e.proposer_id!==o&&(b[e.proposer_id]=(b[e.proposer_id]||0)+1)}),Object.entries(b).forEach(([e,t])=>{s[e]=s[e]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},s[e].projects_proposed=t,r[e]=(r[e]||0)+t*5}),U?.forEach(e=>{if(e.user_id!==o){let t=0;s[e.user_id]=s[e.user_id]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},e.want&&e.want.trim()!==""&&(s[e.user_id].wants+=1,t+=1),e.give&&e.give.trim()!==""&&(s[e.user_id].offers+=1,t+=1),e.passion&&e.passion.trim()!==""&&(s[e.user_id].passion+=1,t+=1),r[e.user_id]=(r[e.user_id]||0)+t}});const n={};A?.forEach(e=>{e.user_id!==o&&(n[e.user_id]||(n[e.user_id]=[]),n[e.user_id].push(e))}),Object.entries(n).forEach(([e,t])=>{s[e]=s[e]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0};let a=0;t.forEach(c=>{["project","challenge","help","collab","skills","urgency","contact"].forEach(j=>{c[j]&&c[j].trim()!==""&&(a+=1)})}),s[e].projects+=a,r[e]=(r[e]||0)+a}),C?.forEach(e=>{if(e.id!==o){let t=0;e.full_name&&e.full_name.trim()!==""&&t++,e.bio&&e.bio.trim()!==""&&t++,e.avatar_url&&e.avatar_url.trim()!==""&&t++,(e.youtube||e.twitter||e.substack||e.facebook||e.instagram||e.linkedin||e.website)&&t++,t>=2&&(s[e.id]=s[e.id]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},s[e.id].profile=1,r[e.id]=(r[e.id]||0)+5)}}),T?.forEach(e=>{e.created_by&&e.created_by!==o&&(r[e.created_by]=(r[e.created_by]||0)+10,s[e.created_by]=s[e.created_by]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},s[e.created_by].circles_created=(s[e.created_by].circles_created||0)+1)}),M?.forEach(e=>{e.added_by&&e.added_by!==o&&(r[e.added_by]=(r[e.added_by]||0)+2,s[e.added_by]=s[e.added_by]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,positive_impact:0},s[e.added_by].members_added=(s[e.added_by].members_added||0)+1)}),W?.forEach(e=>{e.user_id&&e.user_id!==o&&(r[e.user_id]=(r[e.user_id]||0)+5,s[e.user_id]=s[e.user_id]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,events_created:0,events_attended:0,projects_proposed:0,writer_posts:0,writer_points:0,videos_posted:0,help_hours:0,help_points:0,help_hours_recent:0,positive_impact:0},s[e.user_id].celebrations_posted=(s[e.user_id].celebrations_posted||0)+1)});const{data:v}=await i.from("positive_impact").select("contributor_id, points_awarded");if(v){const e={};v.forEach(t=>{t.contributor_id&&t.points_awarded&&(e[t.contributor_id]=(e[t.contributor_id]||0)+t.points_awarded)}),Object.entries(e).forEach(([t,a])=>{s[t]=s[t]||{votes:0,suggestions:0,comments:0,wants:0,offers:0,passion:0,projects:0,profile:0,circles_created:0,members_added:0,celebrations_posted:0,support_responses:0,events_created:0,events_attended:0,projects_proposed:0,writer_posts:0,writer_points:0,videos_posted:0,help_hours:0,help_points:0,help_hours_recent:0,positive_impact:0},s[t].positive_impact=a,r[t]=(r[t]||0)+a})}const g=Object.keys(r).filter(e=>e&&e!=="null");if(g.length===0)return[];const{data:H}=await i.from("profiles").select("id, full_name, avatar_url, personal_story"),w={};H?.forEach(e=>{w[e.id]=e});const y=g.map(e=>({id:e,profile:w[e]||{full_name:e,avatar_url:"",personal_story:""},total:r[e],breakdown:s[e]}));return y.sort((e,t)=>t.total-e.total),y}async function R(){const o=await N(),r=document.getElementById("members");if(!o||o.length===0){r.innerHTML="<em>No member activities yet.</em>";return}r.innerHTML=o.map(s=>`
                <div class="member-card">
                    <img src="${s.profile.avatar_url||"default-avatar.png"}" alt="Profile Picture">
                    <div class="member-info">
                        <h2>${s.profile.full_name||s.id}</h2>
                        <div class="activity-breakdown">
                            <strong>All-Time Activities:</strong><br>
                            Votes: ${s.breakdown.votes||0}<br>
                            Suggestions: ${s.breakdown.suggestions||0}<br>
                            Comments: ${s.breakdown.comments||0}<br>
                            Wants: ${s.breakdown.wants||0}<br>
                            Offers: ${s.breakdown.offers||0}<br>
                            Passion: ${s.breakdown.passion||0}<br>
                            Projects & Struggles: ${s.breakdown.projects||0}<br>
                            <span style="color:#4a7c59;font-weight:bold;">Writer's Posts: ${s.breakdown.writer_posts||0}</span><br>
                            <span style="color:#4a7c59;font-weight:bold;">Videos Posted: ${s.breakdown.videos_posted||0}</span><br>
                            Help Given: ${s.breakdown.help_hours_recent||0}<br>
                            Profile Completed: ${s.breakdown.profile?"✔️":"—"}<br>
                            Circles Created: ${s.breakdown.circles_created||0}<br>
                            Events Created: ${s.breakdown.events_created||0}<br>
                            Events Attended: ${s.breakdown.events_attended||0}<br>
                            Members Added: ${s.breakdown.members_added||0}<br>
                            Celebration Wall Posts: ${s.breakdown.celebrations_posted||0}<br>
                            Projects Proposed: ${s.breakdown.projects_proposed||0}<br>
                            Support Responses: ${s.breakdown.support_responses||0}<br>
                            Positive Impact: ${s.breakdown.positive_impact||0}<br>
                            <strong>Total:</strong> ${s.total}
                        </div>
                        <div class="personal-story">${s.profile.personal_story||""}</div>
                    </div>
                </div>
            `).join("")}R();
