import"./modulepreload-polyfill-B5Qt9EMX.js";import{s as c}from"./supabase-vDZkBp_j.js";const l=document.getElementById("contribution-form"),e=document.getElementById("status-message"),i=document.getElementById("save-btn"),s=document.getElementById("delete-btn");let u,r=null;async function d(){const{data:{user:n}}=await c.auth.getUser();if(!n){e.textContent="⚠️ You must be logged in to edit your scroll.",e.style.color="red",l.style.display="none";return}u=n;const{data:o,error:a}=await c.from("contributions").select("*").eq("user_id",n.id);if(a){e.textContent=`Error loading scroll: ${a.message}`,e.style.color="red";return}if(o&&o.length>0){const t=o[0];r=t.id,l.project.value=t.project||"",l.challenge.value=t.challenge||"",l.help.value=t.help||"",l.collab.value=t.collab||"",l.skills.value=t.skills||"",l.urgency.value=t.urgency||"",l.contact.value=t.contact||"",s.style.display="",i.textContent="Update Projects & Struggles"}else r=null,l.reset(),s.style.display="none",i.textContent="Submit Your Projects & Struggles"}l.addEventListener("submit",async n=>{n.preventDefault(),i.disabled=!0,e.textContent="Saving...",e.style.color="black";const o=new FormData(l),a={user_id:u.id,project:o.get("project"),challenge:o.get("challenge"),help:o.get("help"),collab:o.get("collab"),skills:o.get("skills"),urgency:o.get("urgency"),contact:o.get("contact")};let t;r?{error:t}=await c.from("contributions").update(a).eq("id",r):{error:t}=await c.from("contributions").insert(a),t?(e.textContent=`Error: ${t.message}`,e.style.color="red"):(e.textContent="✅ Your Projects & Struggles have been saved!",e.style.color="green",setTimeout(()=>{e.textContent=""},3e3),await d()),i.disabled=!1});s.addEventListener("click",async()=>{if(!r||!confirm("Are you sure you want to delete your scroll?"))return;s.disabled=!0,e.textContent="Deleting...",e.style.color="black";const{error:n}=await c.from("contributions").delete().eq("id",r);n?(e.textContent=`Error: ${n.message}`,e.style.color="red"):(e.textContent="✅ Your Projects & Struggles have been deleted.",l.reset(),r=null,s.style.display="none",i.textContent="Submit Your Scroll"),s.disabled=!1});d();
